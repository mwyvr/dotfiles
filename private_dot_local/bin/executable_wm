#!/bin/sh
WM=river

export XDG_SESSION_TYPE=wayland
export XDG_SESSION_DESKTOP=river
export XDG_CURRENT_DESKTOP=river
export MOZ_ENABLE_WAYLAND=1
export XKB_DEFAULT_OPTIONS=ctrl:nocaps

eval $(gnome-keyring-daemon --start)
export SSH_AUTH_SOCK

. /etc/os-release
case $ID in
chimera)
    dbus-run-session $WM $@
    ;;
freebsd)
    dbus-launch --sh-syntax --exit-with-session $WM $@
    # not cleaning up on FreeBSD for some reason, TODO
    pkill chrome
    ;;
"opensuse-tumbleweed")
    $WM $@
    ;;
*)
    echo "Unknown operating system: [$OS], terminating."
    exit 1
    ;;
esac

# cleanup the display daemon started in river/init
# pkill kanshi
