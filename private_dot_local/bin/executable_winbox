#!/bin/sh
. /etc/os-release
export EXE="$HOME/.local/bin/winbox64.exe"

if ! command -v /usr/bin/wine64; then
    case $ID in
    chimera)
        FETCHER=fetch
        ;;
    void)
        FETCHER=wget
        ;;
    "opensuse-tumbleweed")
        # Likely in distrobox container
        FETCHER=wget
        ;;
    *)
        echo "Unknown Linux distribution, terminating."
        exit 1
        ;;
    esac
fi

# download if not already done
if [ ! -f "$EXE" ]; then
    $FETCHER -o $EXE https://mt.lv/winbox64
fi

if [ -z "${CONTAINER_ID}" ]; then
    echo "Enter tw container, then run winbox"
else
    exec /usr/bin/wine64 $EXE
fi
